<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SOBA Calgary - Strengthening Communities Together</title>
    <meta name="description" content="SOBA Calgary is a community-based, non-profit organization dedicated to improving lives through poverty reduction, youth development, skills training, and community engagement programs." />
    <!-- PiPilot Console Bridge - Captures console logs for preview panel -->
    <script>
      (function() {
        window.__PIPILOT_EARLY_ERRORS__ = [];
        window.onerror = function(msg, url, line, col, error) {
          var errorData = { __isError: true, name: error?.name || 'Error', message: msg, stack: error?.stack || ('at ' + url + ':' + line + ':' + col) };
          window.__PIPILOT_EARLY_ERRORS__.push(errorData);
          try { window.parent.postMessage({ type: 'BROWSER_CONSOLE_LOG', payload: { method: 'error', data: [errorData], timestamp: new Date().toISOString(), id: 'error-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9) } }, '*'); } catch(e) {}
          return false;
        };
        window.onunhandledrejection = function(event) {
          var errorData = { __isError: true, name: 'UnhandledPromiseRejection', message: String(event.reason), stack: event.reason?.stack || '' };
          window.__PIPILOT_EARLY_ERRORS__.push(errorData);
          try { window.parent.postMessage({ type: 'BROWSER_CONSOLE_LOG', payload: { method: 'error', data: [errorData], timestamp: new Date().toISOString(), id: 'rejection-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9) } }, '*'); } catch(e) {}
        };
        var originalConsole = { log: console.log, warn: console.warn, error: console.error, info: console.info, debug: console.debug };
        function sendToParent(method, args) {
          try {
            var serializedArgs = Array.prototype.slice.call(args).map(function(arg) {
              if (arg instanceof Error) return { __isError: true, name: arg.name, message: arg.message, stack: arg.stack };
              try { return JSON.parse(JSON.stringify(arg)); } catch(e) { return String(arg); }
            });
            window.parent.postMessage({ type: 'BROWSER_CONSOLE_LOG', payload: { method: method, data: serializedArgs, timestamp: new Date().toISOString(), id: method + '-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9) } }, '*');
          } catch(e) {}
        }
        console.log = function() { originalConsole.log.apply(console, arguments); sendToParent('log', arguments); };
        console.warn = function() { originalConsole.warn.apply(console, arguments); sendToParent('warn', arguments); };
        console.error = function() { originalConsole.error.apply(console, arguments); sendToParent('error', arguments); };
        console.info = function() { originalConsole.info.apply(console, arguments); sendToParent('info', arguments); };
        console.debug = function() { originalConsole.debug.apply(console, arguments); sendToParent('debug', arguments); };
        setTimeout(function() { window.__PIPILOT_EARLY_ERRORS__.forEach(function(err) { sendToParent('error', [err]); }); }, 100);
      })();
    </script>

    <!-- Google Fonts Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Google Fonts - Common font families -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Lora:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- WhatsApp Chat Widget -->
    <script src="https://cdn.jsdelivr.net/npm/wa-chat-widget"></script>
    <script>
      // Initialize WhatsApp widget after DOM loads
      document.addEventListener('DOMContentLoaded', function() {
        if (typeof waChatWidget !== 'undefined') {
          waChatWidget.init({
            phone: '14035551234',              // Calgary area code (403) - placeholder number
            message: 'Hello! How can I help you today?',  // Pre-filled message
            position: 'br',                    // Bottom right position
            size: 60,                          // Icon size in px
          });
        }
      });
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- Visual Editor Client - enables visual editing when loaded in pipilot.dev iframe -->
    <script src="/visual-editor-client.js" defer></script>
  </body>
</html>